(("undefined"!==typeof self?self:this)["webpackChunkmap"]=("undefined"!==typeof self?self:this)["webpackChunkmap"]||[]).push([[725],{9019:function(t,e,i){"use strict";i.d(e,{Z:function(){return c}});var o=function(){var t=this,e=t._self._c;return t.isGroup?e("MapButton",t._g(t._b({attrs:{active:t.active,elevation:"0",fab:"",height:t.groupSize,text:"",title:t.tooltip||t.title,width:t.groupSize}},"MapButton",t.$attrs,!1),t.$listeners),[t._t("default",(function(){return[e("MapIcon",[t._v(" "+t._s(t.icon)+" ")])]}))],2):e("div",{staticClass:"button-container"},[e("div",{attrs:{title:t.tooltip||t.title}},[t._t("default",(function(){return[e("MapButton",t._g(t._b({staticClass:"button-elevation",attrs:{height:t.size,loading:t.loading,width:t.size}},"MapButton",t.$attrs,!1),t.$listeners),[t._t("default",(function(){return[e("MapIcon",[t._v(" "+t._s(t.icon)+" ")])]}))],2)]}))],2)])},n=[],s=i(1875),a=i(7121),r={components:{MapButton:s.Z,MapIcon:a.Z},props:{icon:{type:String},tooltip:String,title:String,loading:Boolean,size:{type:Number,default:32},active:Boolean},inject:{isGroup:{default:!1},groupSize:{default:0,from:"size"}},computed:{}},h=r,l=i(1001),u=(0,l.Z)(h,o,n,!1,null,"6efba1d6",null),c=u.exports},1934:function(t,e,i){"use strict";i.d(e,{Z:function(){return c}});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"button-container button-group-container",class:{"button-group-row-container":t.row,"button-group-column-container":!t.row},style:{width:t.row?null:t.size+"px",height:t.row?t.size+"px":null}},[e("div",{staticClass:"button-group-sheet button-elevation",class:{"button-group-sheet-column":!t.row},staticStyle:{"border-radius":"150px"}},[t._l(t.items,(function(i,o){return e("MapButton",{key:o+""+i.titl,attrs:{height:t.size,text:"",title:i.title,width:t.size},on:{click:i.onClick}},[e("MapIcon",[t._v(" "+t._s(i.icon)+" ")])],1)})),t._t("default")],2)])},n=[],s=i(1875),a=i(7121),r={components:{MapButton:s.Z,MapIcon:a.Z},props:{items:{type:Array,default:()=>[]},row:Boolean,size:{type:Number,default:32}},provide(){return{isGroup:!0,size:this.size}}},h=r,l=i(1001),u=(0,l.Z)(h,o,n,!1,null,"7f7a17c4",null),c=u.exports},7725:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return y}});var o=function(){var t=this,e=t._self._c;return e("ModuleContainer",t._b({scopedSlots:t._u([{key:"btn",fn:function(){return[t.print.show?[e("MapControlGroupButton",{attrs:{row:""}},[e("MapControlButton",{attrs:{icon:"mdi-content-save-outline",loading:t.print.loading,tooltip:t.trans("actions.save")},on:{click:function(e){return t.onSave()}}}),e("MapControlButton",{attrs:{disabled:t.print.loading,icon:"mdi-close",tooltip:t.trans("actions.clear")},on:{click:function(e){return t.onClosePrint()}}})],1)]:e("MapControlButton",{attrs:{active:t.print.show,icon:"mdi-printer-outline",tooltip:"In áº¥n"},on:{click:function(e){return t.onSaveAll()}}})]},proxy:!0}])},"ModuleContainer",t.bindModule,!1),[t._t("default")],2)},n=[],s=i(9019),a=i(1934),r=i(7349),h=i(1037);class l{constructor(t){this.mapCanvas=t,this.color="#535353"}create(){this.updateValues(),this.createCanvas(this.mapCanvas.parentElement)}updateValues(){this.width=this.mapCanvas.clientWidth,this.height=this.mapCanvas.clientHeight}mapResize(){this.updateValues(),this.updateCanvas()}updateCanvas(){if(void 0!==this.svgCanvas&&void 0!==this.yLine&&void 0!==this.xLine&&void 0!==this.width&&void 0!==this.height){this.svgCanvas.setAttribute("width",`${this.width}px`),this.svgCanvas.setAttribute("height",`${this.height}px`);const t=this.width/2,e=this.height/2;this.yLine.setAttribute("x1",`${t}px`),this.yLine.setAttribute("y1","0px"),this.yLine.setAttribute("x2",`${t}px`),this.yLine.setAttribute("y2",`${this.height}px`),this.xLine.setAttribute("x1","0px"),this.xLine.setAttribute("y1",`${e}px`),this.xLine.setAttribute("x2",`${this.width}px`),this.xLine.setAttribute("y2",`${e}px`)}else console.error("element value is null")}createCanvas(t){if(void 0!==this.width&&void 0!==this.height){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style["pointer-events"]="none",e.setAttribute("width",`${this.width}px`),e.setAttribute("height",`${this.height}px`);const i=this.width/2,o=this.height/2;this.yLine=e.appendChild(this.createLine(i,0,i,this.height,this.color,"2px")),this.xLine=e.appendChild(this.createLine(0,o,this.width,o,this.color,"2px")),t.appendChild(e),this.svgCanvas=e}}createLine(t,e,i,o,n,s){const a=document.createElementNS("http://www.w3.org/2000/svg","line");return a.setAttribute("x1",t),a.setAttribute("y1",e),a.setAttribute("x2",i),a.setAttribute("y2",o),a.setAttribute("stroke-dasharray","5,5"),a.setAttribute("stroke",n),a.setAttribute("stroke-width",s),a}destroy(){void 0!==this.xLine&&(this.xLine.remove(),this.xLine=void 0),void 0!==this.yLine&&(this.yLine.remove(),this.yLine=void 0),void 0!==this.svgCanvas&&(this.svgCanvas.remove(),this.svgCanvas=void 0)}}var u=i(7205),c=i.n(u);function p(t){const e=document.createElement("div");e.className="hidden-map",document.body.appendChild(e);let i=t.getCanvas();const o=document.createElement("div");o.style.width=i.clientWidth+"px",o.style.height=i.clientHeight+"px",e.appendChild(o);const n=new(c().Map)({container:o,center:t.getCenter(),zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1,transformRequest:t._requestManager._transformRequestFn}),s=t.getStyle();if(s&&s.sources){const t=s.sources;Object.keys(t).forEach((e=>{const i=t[e];Object.keys(i).forEach((t=>{i[t]||delete i[t]}))}))}return n.setStyle(s),new Promise((t=>{n.once("idle",(()=>{const i=n.getCanvas();t(i.toDataURL()),n.remove(),e.parentNode?.removeChild(e)}))}))}class d{constructor(t,e=1){this.mapCanvas=t,this.ratio=e}getCutSize(){return{width:this.cutWidth,height:this.cutHeight,startX:this.cutStartX,startY:this.cutStartY}}mapResize(){this.generateCutOut()}create(){this.createCanvas(this.mapCanvas.parentElement),this.generateCutOut()}createCanvas(t){const e=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=this.mapCanvas.clientWidth,o=this.mapCanvas.clientHeight;e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style["pointer-events"]="none",e.setAttribute("width",`${i}px`),e.setAttribute("height",`${o}px`);const n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("style","fill:#888888;stroke-width:0"),n.setAttribute("fill-opacity","0.5"),e.append(n),t.appendChild(e),this.svgCanvas=e,this.svgPath=n}generateCutOut(){if(void 0===this.svgCanvas||void 0===this.svgPath)return;const t=this.mapCanvas.clientWidth,e=this.mapCanvas.clientHeight;this.ratio>=1?(this.cutWidth=Math.floor(4*e/5-30),this.cutHeight=this.cutWidth/this.ratio):(this.cutHeight=Math.floor(4*e/5-30),this.cutWidth=Math.floor(this.cutHeight*this.ratio)),this.cutStartX=t/2-this.cutWidth/2,this.cutStartY=e/2-this.cutHeight/2;const i=this.cutHeight,o=this.cutWidth,n=this.cutStartX,s=n+o,a=this.cutStartY,r=a+i;this.svgCanvas.setAttribute("width",`${t}px`),this.svgCanvas.setAttribute("height",`${e}px`),this.svgPath.setAttribute("d",`M 0 0 L ${t} 0 L ${t} ${e} L 0 ${e} M ${n} ${a} L ${n} ${r} L ${s} ${r} L ${s} ${a}`)}destroy(){void 0!==this.svgCanvas&&(this.svgCanvas.remove(),this.svgCanvas=void 0)}}const v={},g=(t,{show:e,close:i,save:o,saveAll:n})=>{v[t]={show:e,close:i,save:o,saveAll:n}};var f={components:{MapControlButton:s.Z,MapControlGroupButton:a.Z},mixins:[r.Z],data:()=>({print:{show:!1,loading:!1}}),methods:{onDestroy(){this.onClosePrint()},async onSaveAll(t){this.print.loading=!0;try{let e=await p(this.map);t?t(e):await this.onDownload(e)}finally{this.print.loading=!1}},async onSave(t){if(this.printableArea){this.print.loading=!0;try{let e=await p(this.map,this.printableArea.getCutSize());t?t(e):await this.onDownload(e)}finally{this.print.loading=!1}}},onShowPrint(t){this.print.show=!0,this.toggleCrosshair(this.print.show,t),this.togglePrintableArea(this.print.show,t),this.map.on("resize",this.mapResizeBind)},onClosePrint(){this.print.loading=!1,this.print.show=!1,this.toggleCrosshair(this.print.show),this.togglePrintableArea(this.print.show),this.map&&this.map.off("resize",this.mapResizeBind)},togglePrintableArea(t,{ratio:e=1}={}){!1===t?void 0!==this.printableArea&&(this.printableArea.destroy(),this.printableArea=void 0):(this.printableArea=new d(this.map.getCanvas(),e),this.printableArea.create())},toggleCrosshair(t){!1===t?void 0!==this.crosshair&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new l(this.map.getCanvas()),this.crosshair.create())},onInit(){this.mapResizeBind=this.onMapResize.bind(this),g(this.mapId,{show:t=>this.onShowPrint(t),close:()=>this.onClosePrint(),save:t=>this.onSave(t),saveAll:t=>this.onSaveAll(t)})},onMapResize(){this.printableArea&&this.printableArea.mapResize(),this.crosshair&&this.crosshair.mapResize()},async onDownload(t){this.$listeners["click:download"]?this.$emit("click:download",t):(0,h.saveAs)(t,"map.png")}}},m=f,b=i(1001),w=(0,b.Z)(m,o,n,!1,null,null,null),y=w.exports},1037:function(t,e,i){var o,n,s;(function(i,a){n=[],o=a,s="function"===typeof o?o.apply(e,n):o,void 0===s||(t.exports=s)})(0,(function(){"use strict";function e(t,e){return"undefined"==typeof e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function o(t,e,i){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){h(o.response,e,i)},o.onerror=function(){console.error("could not download file")},o.send()}function n(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function s(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(o){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof i.g&&i.g.global===i.g?i.g:void 0,r=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),h=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(t,e,i){var r=a.URL||a.webkitURL,h=document.createElement("a");e=e||t.name||"download",h.download=e,h.rel="noopener","string"==typeof t?(h.href=t,h.origin===location.origin?s(h):n(h.href)?o(t,e,i):s(h,h.target="_blank")):(h.href=r.createObjectURL(t),setTimeout((function(){r.revokeObjectURL(h.href)}),4e4),setTimeout((function(){s(h)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,i,a){if(i=i||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,a),i);else if(n(t))o(t,i,a);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout((function(){s(r)}))}}:function(t,e,i,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof t)return o(t,e,i);var s="application/octet-stream"===t.type,h=/constructor/i.test(a.HTMLElement)||a.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||s&&h||r)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var t=u.result;t=l?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=t:location=t,n=null},u.readAsDataURL(t)}else{var c=a.URL||a.webkitURL,p=c.createObjectURL(t);n?n.location=p:location.href=p,n=null,setTimeout((function(){c.revokeObjectURL(p)}),4e4)}});a.saveAs=h.saveAs=h,t.exports=h}))},7349:function(t,e,i){"use strict";i.d(e,{Z:function(){return p}});i(6699);var o=i(5947),n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"module__container"},[t.controlVisible&&t.$slots["btn"]?e("portal",{attrs:{order:t.order,to:t.btnTo}},[e("div",[t._t("btn")],2)]):t._e(),t._t("default"),e("portal",{attrs:{to:t.draggableTo}},[t._t("draggable",null,null,t.bindDrag)],2)],2)},s=[],a=i(6128),r={components:{Portal:a.h_},props:{prefix:{type:String,default:"mapbox"},btnWidth:{type:Number,default:32},position:{type:String,default:"bottom-right",validator(t){return-1!==["top-left","top-right","bottom-left","bottom-right"].indexOf(t)}},controlVisible:{type:Boolean,default:!0},order:{type:Number,default:0}},computed:{btnTo(){return`${this.position}-${this.prefix}`},draggableTo(){return`map-draggable-${this.prefix}`},bindDrag(){let t={};return this.position.includes("left")&&(t.left=18+this.btnWidth),this.position.includes("right")&&(t.right=18+this.btnWidth),this.position.includes("top")&&(t.top=10),this.position.includes("bottom")&&(t.bottom=10),t}}},h=r,l=i(1001),u=(0,l.Z)(h,n,s,!1,null,"beabf37e",null),c=u.exports,p={components:{ModuleContainer:c},props:{position:{type:String,default:"bottom-right",validator(t){return-1!==["top-left","top-right","bottom-left","bottom-right"].indexOf(t)}},controlVisible:{type:Boolean,default:!0},order:{type:Number,default:0}},data(){return{loaded:!1}},watch:{},inject:["getMap","mapId","trans"],computed:{isLeft(){return this.position.includes("left")},isRight(){return this.position.includes("right")},isTop(){return this.position.includes("top")},isBottom(){return this.position.includes("bottom")},bindModule(){return{controlVisible:this.controlVisible,order:this.order,position:this.position,prefix:this.mapId}}},mounted(){this.$once("module-loaded",(()=>{this.loaded=!0})),this.$on("module-failed",(()=>{this.loaded=!1})),this.getMap((async t=>{if(this.map=t,this.onInit instanceof Function){const t=this.onInit();if(t instanceof Promise)try{await t}catch(e){throw this.$emit("module-failed"),e}}this.$emit("module-loaded")}))},destroyed(){if(this.onDestroy instanceof Function)try{this.onDestroy()}catch(t){console.error(t)}this.map=null},methods:{removeListenerMap(t,e){(0,o.sq)(this.mapId,t,e)},addListenerMap(t,e,i){(0,o.bb)(this.mapId,t,e,i)},actionAfterMapLoaded(t){if(!this.map)return this.$once("module-loaded",(()=>{t()}));t()},removeSource(t){this.map.getSource(t)&&this.map.removeSource(t)},addLayer(t,e){if(!this.map)return this.$once("module-loaded",(()=>{this.addLayer(t,e)}));this.map.addLayer(t,e)},removeLayer(t){this.map&&(this.map.getLayer(t)&&this.map.removeLayer(t),this.map.getSource(t)&&this.map.removeSource(t))}}}}}]);
//# sourceMappingURL=map.umd.min.725.js.map